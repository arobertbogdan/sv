<% if !notice.nil? %>
    <div class="alert alert-success col-md-9" role="alert">
      <p id="notice"><%= notice %></p>
    </div>
<% end %>

<div class="main-content">
  <div class="posts col-md-9">
    <ul class="list-unstyled">
      <%= render partial: "posts/post_user", collection: @posts %>
    </ul>
  </div> <!-- end of posts -->
</div>

<div class="col-md-3"> <!-- sidebar -->
  <aside>
    <h4 class="text-center"><%= @user.nickname %></h4>
    <div style="margin: auto; text-align: center">
        <%= image_tag @user.avatar.url(:medium), class: 'avatar' %>
    </div>
    <%= form_for :user, url: avatar_path(@user.id), html: { method: :put, :multipart => true } do |form| %>
        <div class="form-group">
            <%= form.file_field :avatar, class: 'form-control' %>
            <%= form.submit 'Submit', class: 'btn btn-default pull-right' %>
        </div>
    <% end %>

    <% if user_signed_in? && @user.id != current_user.id %>
        <% if current_user.is_following @user %>
            <%= link_to 'Unfollow', unfollow_path(:id => @user.id), method: :post, class: 'btn btn-primary btn-block' %>
        <% else %>
            <%= link_to 'Follow', follow_path(:id => @user.id), method: :post, class: 'btn btn-primary btn-block' %>
        <% end %>
    <% end %>


    <p class="text-center">Post karma: <span><%= @karma %></span></p>
    <%= link_to 'Submit New Content',  new_post_path, class: 'btn btn-primary btn-block'  %>
    <h4 class="text-center">SUBSCRIPTIONS</h4>
    <ul class="list-unstyled">
      <% @followers.each do |follow| %>
          <li class="list-group-item">
            <% if user_signed_in? %>
                <span class="badge"><%= follow.count_new_posts @user %></span>
            <% end %>
            <%= image_tag follow.get_avatar %>
            <%= link_to follow.nickname, profile_path(:id => follow.follow_id) %>
          </li>
      <% end %>
    </ul>
  </aside>
</div> <!-- end of sidebar -->